{
  "timestamp": "2025-07-11T11:54:44.891295+00:00",
  "database_config": {
    "endpoint": "voice-biomarker-users-db.cnq0agmieipg.eu-central-1.rds.amazonaws.com",
    "port": 5432,
    "database": "voice_biomarker_users",
    "username": "postgres",
    "ssl_mode": "require"
  },
  "tests": {
    "Environment Variables": {
      "status": "passed",
      "message": "All required environment variables are set",
      "details": {
        "checked_variables": [
          "RDS_PASSWORD"
        ]
      },
      "timestamp": "2025-07-11T11:54:44.891444+00:00"
    },
    "Database Connection": {
      "status": "passed",
      "message": "Connection successful in 478.36ms",
      "details": {
        "connection_time_ms": 478.36,
        "postgresql_version": "PostgreSQL 17.4 on aarch64-unknown-linux-gnu, compiled by gcc (GCC) 12.4.0, 64-bit",
        "test_query_result": 1
      },
      "timestamp": "2025-07-11T11:54:45.456486+00:00"
    },
    "Database Configuration": {
      "status": "passed",
      "message": "Database configuration is optimal",
      "details": {
        "ssl_enabled": "on",
        "encoding": "UTF8",
        "timezone": "UTC",
        "max_connections": "79",
        "permissions": "CREATE/DROP table permissions verified"
      },
      "timestamp": "2025-07-11T11:54:45.603175+00:00"
    },
    "Schema Accessibility": {
      "status": "passed",
      "message": "Schema accessible, connected to voice_biomarker_users as postgres",
      "details": {
        "schema_accessible": true,
        "current_database": "voice_biomarker_users",
        "current_user": "postgres",
        "expected_database": "voice_biomarker_users"
      },
      "timestamp": "2025-07-11T11:54:45.684828+00:00"
    },
    "Table Structure": {
      "status": "passed",
      "message": "All 9 expected tables exist",
      "details": {
        "expected_tables": [
          "users",
          "user_roles",
          "user_role_assignments",
          "audio_files",
          "voice_analyses",
          "user_sessions",
          "notification_preferences",
          "notification_history",
          "audit_logs"
        ],
        "existing_tables": [
          "alembic_version",
          "users",
          "audio_files",
          "audit_logs",
          "notification_history",
          "notification_preferences",
          "user_role_assignments",
          "user_roles",
          "user_sessions",
          "voice_analyses"
        ],
        "missing_tables": [],
        "extra_tables": [],
        "table_details": {
          "users": {
            "exists": true,
            "column_count": 15,
            "columns": [
              "id",
              "email",
              "password_hash",
              "first_name",
              "last_name"
            ]
          },
          "user_roles": {
            "exists": true,
            "column_count": 4,
            "columns": [
              "id",
              "name",
              "description",
              "created_at"
            ]
          },
          "user_role_assignments": {
            "exists": true,
            "column_count": 5,
            "columns": [
              "id",
              "user_id",
              "role_id",
              "assigned_at",
              "assigned_by"
            ]
          },
          "audio_files": {
            "exists": true,
            "column_count": 12,
            "columns": [
              "id",
              "user_id",
              "filename",
              "file_path",
              "file_size"
            ]
          },
          "voice_analyses": {
            "exists": true,
            "column_count": 11,
            "columns": [
              "id",
              "audio_file_id",
              "arousal",
              "valence",
              "dominance"
            ]
          },
          "user_sessions": {
            "exists": true,
            "column_count": 12,
            "columns": [
              "id",
              "user_id",
              "device_id",
              "device_type",
              "ip_address"
            ]
          },
          "notification_preferences": {
            "exists": true,
            "column_count": 11,
            "columns": [
              "id",
              "user_id",
              "reminder_enabled",
              "reminder_frequency",
              "reminder_time"
            ]
          },
          "notification_history": {
            "exists": true,
            "column_count": 9,
            "columns": [
              "id",
              "user_id",
              "notification_type",
              "channel",
              "subject"
            ]
          },
          "audit_logs": {
            "exists": true,
            "column_count": 9,
            "columns": [
              "id",
              "user_id",
              "action",
              "resource_type",
              "resource_id"
            ]
          }
        }
      },
      "timestamp": "2025-07-11T11:54:46.212015+00:00"
    },
    "Database Indexes": {
      "status": "passed",
      "message": "All critical indexes are present",
      "details": {
        "index_status": {
          "users": {
            "expected": [
              "ix_users_email",
              "ix_users_created_at"
            ],
            "existing": [
              "ix_users_created_at",
              "ix_users_email"
            ],
            "missing": []
          },
          "audio_files": {
            "expected": [
              "ix_audio_files_user_id",
              "ix_audio_files_uploaded_at"
            ],
            "existing": [
              "ix_audio_files_uploaded_at",
              "ix_audio_files_user_id"
            ],
            "missing": []
          },
          "voice_analyses": {
            "expected": [
              "ix_voice_analyses_audio_file_id",
              "ix_voice_analyses_analyzed_at"
            ],
            "existing": [
              "ix_voice_analyses_analyzed_at",
              "ix_voice_analyses_audio_file_id"
            ],
            "missing": []
          },
          "user_sessions": {
            "expected": [
              "ix_user_sessions_user_id",
              "ix_user_sessions_expires_at"
            ],
            "existing": [
              "ix_user_sessions_expires_at",
              "ix_user_sessions_user_id"
            ],
            "missing": []
          },
          "audit_logs": {
            "expected": [
              "ix_audit_logs_user_id",
              "ix_audit_logs_timestamp"
            ],
            "existing": [
              "ix_audit_logs_timestamp",
              "ix_audit_logs_user_id"
            ],
            "missing": []
          }
        }
      },
      "timestamp": "2025-07-11T11:54:46.589981+00:00"
    },
    "Database Constraints": {
      "status": "passed",
      "message": "Database constraints verified (6 foreign keys found)",
      "details": {
        "foreign_key_status": {
          "user_role_assignments": {
            "foreign_key_count": 3,
            "foreign_keys": [
              "user_role_assignments_assigned_by_fkey",
              "user_role_assignments_role_id_fkey",
              "user_role_assignments_user_id_fkey"
            ]
          },
          "audio_files": {
            "foreign_key_count": 1,
            "foreign_keys": [
              "audio_files_user_id_fkey"
            ]
          },
          "voice_analyses": {
            "foreign_key_count": 1,
            "foreign_keys": [
              "voice_analyses_audio_file_id_fkey"
            ]
          },
          "user_sessions": {
            "foreign_key_count": 1,
            "foreign_keys": [
              "user_sessions_user_id_fkey"
            ]
          }
        },
        "users_unique_constraints": []
      },
      "timestamp": "2025-07-11T11:54:46.903362+00:00"
    },
    "CRUD Operations": {
      "status": "passed",
      "message": "CRUD operations completed successfully",
      "details": {
        "create_success": true,
        "read_success": true,
        "update_success": true,
        "delete_success": true
      },
      "timestamp": "2025-07-11T11:54:47.271775+00:00"
    },
    "Table Relationships": {
      "status": "passed",
      "message": "Table relationships working correctly",
      "details": {
        "user_sessions_relationship": true,
        "notification_preferences_relationship": true,
        "cascade_delete_ready": true
      },
      "timestamp": "2025-07-11T11:54:47.665750+00:00"
    },
    "Performance Metrics": {
      "status": "passed",
      "message": "Performance metrics acceptable - Average: 54.60ms",
      "details": {
        "simple_query_avg_ms": 54.6,
        "simple_query_max_ms": 88.69,
        "simple_query_min_ms": 44.98,
        "complex_query_ms": 51.43,
        "performance_threshold_ms": 1000
      },
      "timestamp": "2025-07-11T11:54:48.037415+00:00"
    },
    "SSL Connection": {
      "status": "passed",
      "message": "SSL connection verified (cipher: Unable to determine)",
      "details": {
        "ssl_enabled": "on",
        "ssl_cipher": "Unable to determine",
        "ssl_version": "Unable to determine",
        "expected_ssl_mode": "require"
      },
      "timestamp": "2025-07-11T11:54:48.114020+00:00"
    },
    "Connection Pool": {
      "status": "passed",
      "message": "Connection pool verified (size: 5, checked out: 0)",
      "details": {
        "pool_size": 5,
        "checked_out": 0,
        "overflow": -5,
        "checked_in": 0,
        "configured_pool_size": 5,
        "configured_max_overflow": 10,
        "concurrent_connections_test": "Success"
      },
      "timestamp": "2025-07-11T11:54:48.802915+00:00"
    },
    "Migration Status": {
      "status": "passed",
      "message": "Migrations up to date (version: 0c2edd88...)",
      "details": {
        "alembic_table_exists": true,
        "current_version": "0c2edd885108",
        "migration_files_count": 1
      },
      "timestamp": "2025-07-11T11:54:48.850940+00:00"
    }
  },
  "summary": {
    "total_tests": 13,
    "passed": 13,
    "failed": 0,
    "warnings": 0
  }
}